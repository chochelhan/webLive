"use strict";(self["webpackChunklivego"]=self["webpackChunklivego"]||[]).push([[7318],{37318:function(t,i,e){e.r(i),e.d(i,{default:function(){return _}});var s=function(){var t=this,i=t.$createElement,s=t._self._c||i;return s("div",{staticClass:"mypage-container"},[t.mobileView?s("div",{staticClass:"top-menu-bar"},[s("div",{staticClass:"top-menu-bar-content"},[s("div",{staticClass:"back-button",on:{click:function(i){return t.$router.go(-1)}}},[s("i",{staticClass:"fas fa-chevron-left"})]),s("span",{staticClass:"m-title"},[t._v("엑셀로 업로드 ")])])]):t._e(),s("div",{class:"contents "+t.mobileClass},[s("div",{staticClass:"from-box"},[t.mobileView?t._e():s("div",{staticClass:"sTitle"},[s("span",{staticClass:"line"},[t._v("엑셀로 업로드 ")]),s("span",{staticClass:"question-box"},[s("font-awesome-icon",{attrs:{icon:"fa-solid fa-question"}}),t._m(0)],1)]),s("div",{staticClass:"title-desc"},[t._v("엑셀 업로드를 통해 보다 간편하게 시험 문제를 출제할 수 있습니다.")]),s("div",{staticClass:"question-answer-box"},[s("v-expand-transition",[t.guideShow?s("div",{attrs:{id:"guide-description"}},[s("div",{staticClass:"img"},[s("img",{staticStyle:{"max-width":"100%"},attrs:{src:e(70031)}})])]):t._e()]),s("div",{staticClass:"quide-title-box",on:{click:function(i){return t.guideToggle()}}},[s("div",{class:"quide-title "+t.guideClass},[t._v(t._s(t.guideTitle))]),s("div",{staticClass:"guide-icon-box"},[s("div",{staticClass:"guide-icon"},[t.guideShow?s("font-awesome-icon",{attrs:{icon:"fas fa-angle-up"}}):s("font-awesome-icon",{attrs:{icon:"fas fa-angle-down"}})],1)])])],1),s("form",{attrs:{novalidate:""},on:{submit:function(i){return i.preventDefault(),t.validate.apply(null,arguments)}}},[s("ul",{staticClass:"field-box"},[s("li",[s("div",{staticClass:"required-icon"},[t._v("시험명 입력")]),s("div",{staticClass:"field-input"},[s("v-text-field",{attrs:{required:"",placeholder:"시험명을 입력하세요","error-messages":t.nameErrors,outlined:""},on:{input:function(i){return t.$v.name.$touch()},blur:function(i){return t.$v.name.$touch()}},model:{value:t.name,callback:function(i){t.name=i},expression:"name"}})],1)]),s("li",[s("div",{staticClass:"required-icon"},[t._v("출제자 입력")]),s("div",{staticClass:"field-input"},[s("v-text-field",{attrs:{required:"",placeholder:"출제자를 입력하세요","error-messages":t.authorErrors,outlined:""},on:{input:function(i){return t.$v.author.$touch()},blur:function(i){return t.$v.author.$touch()}},model:{value:t.author,callback:function(i){t.author=i},expression:"author"}})],1)]),s("li",[s("div",{staticClass:"required-icon"},[t._v("제한시간 입력")]),s("div",{staticClass:"field-input"},[s("v-text-field",{attrs:{required:"",placeholder:"제한시간을 숫자로 입력하세요 (단위:분)","error-messages":t.timelimitErrors,outlined:""},on:{input:function(i){return t.$v.timelimit.$touch()},blur:function(i){return t.$v.timelimit.$touch()}},model:{value:t.timelimit,callback:function(i){t.timelimit=i},expression:"timelimit"}})],1)]),s("li",{staticStyle:{"padding-bottom":"30px"}},[s("div",{staticClass:"required-icon"},[t._v("엑셀 템플릿 다운로드")]),s("div",{staticClass:"field-input"},[s("v-btn",{staticClass:"down-button",attrs:{type:"button"},on:{click:function(i){return t.sampleDown()}}},[t._v(" 엑셀 템플릿 다운로드 ")])],1)]),s("li",[s("div",{staticClass:"required-icon"},[t._v("파일 업로드")]),s("div",{staticClass:"field-input"},[s("div",{staticClass:"file-box"},[s("div",{staticClass:"file-names"},[t._v(" "+t._s(t.fileName)+" ")]),s("div",{staticClass:"file-click"},[s("input",{ref:"file",attrs:{type:"file",accept:".xls,.xlsx",id:"vfile"},on:{change:t.fileUpload}}),t._v(" 파일 찾기 ")])])])])]),s("p",{staticClass:"submit-button-box"},[s("v-btn",{staticClass:"cancle-button",attrs:{type:"button"}},[t._v(" 취소 ")]),s("v-btn",{staticClass:"submit-button",attrs:{type:"submit"}},[t._v(" 저장 ")])],1)])])])])},a=[function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"menu-title-tip"},[t._v(" 엑셀로 업로드 "),e("div",{staticClass:"description"},[t._v(" 엑셀 업로드를 통해 보다 간편하게 시험 문제를 출제할 수 있습니다. 시험의 기본적인 정보인 시험명, 출제자 정보와 해당 시험에 배당된 시간과 배점을 입력해 주세요. 이후 문제 설정은 엑셀 템플릿을 다운로드하고 엑셀에 문제 입력 후 파일을 업로드하면 됩니다. "),e("br"),e("br"),t._v(" 자세한 내용은 하단의 ‘자세히 알아보기’를 눌러 예시 화면을 살펴보세요 ")])])}],n=e(62032),r=e(4367),o=(e(68309),e(41539),e(54747),e(74916),e(15306),e(39714),e(38862),e(28620)),l=e(40379),u=e(20629),c=e(25494),d=e(89486),m={name:"examSettingExcel",mixins:[o.oE],validations:{name:{required:l.C1},author:{required:l.C1},timelimit:{required:l.C1,numeric:l.uR}},computed:(0,r.Z)((0,r.Z)({},(0,u.Se)("broadcast",["getGno"])),{},{nameErrors:function(){var t=[];return this.$v.name.$dirty?(this.$v.name.required||t.push("시험명을 입력하세요"),t):t},authorErrors:function(){var t=[];return this.$v.author.$dirty?(this.$v.author.required||t.push("출제자를 입력하세요"),t):t},timelimitErrors:function(){var t=[];return this.$v.timelimit.$dirty?(this.$v.timelimit.required||t.push("제한시간을 입력하세요"),this.$v.timelimit.numeric||t.push("제한시간은 숫자만 입력가능합니다"),t):t}}),data:function(){return{insertFlag:!1,mobileView:!1,mobileClass:"",no:"",guideTitle:" 자세히 알아보기",guideShow:!1,guideClass:"",name:"",author:"",timelimit:"",problems:[],fileName:""}},created:function(){this.no=this.getGno},methods:{guideToggle:function(){this.guideShow?(this.guideShow=!1,this.guideTitle="자세히 알아보기",this.guideClass=""):(this.guideShow=!0,this.guideTitle="접기",this.guideClass="center")},fileUpload:function(t){var i=this,e=t.target,s=e.files[0];this.fileName=s.name;var a=new FileReader;a.onload=function(){i.problems=[];var t=a.result,e=window.XLSX.read(t,{type:"binary"});e.SheetNames.forEach((function(t){var s,a=XLSX.utils.sheet_to_json(e.Sheets[t]),r=[],o=0,l=(0,n.Z)(a);try{for(l.s();!(s=l.n()).done;){var u=s.value,c={items:[]};for(var d in u){var m=d.replace(/ /g,"");switch(m){case"문제타입":"S"==u[d].toString()?c.prbType="subject":c.prbType="mchoice";break;case"문제":c.question=u[d].toString();break;case"정답":"subject"==c.prbType?c.subjectGood=u[d].toString():c.good=u[d].toString();break;case"배점":c.jumsu=u[d].toString(),o+=parseInt(u[d].toString());break;case"객관식답1":case"객관식답2":case"객관식답3":case"객관식답4":case"객관식답5":if("mchoice"==c.prbType&&u[d]){var v={answer:u[d].toString(),answerErrors:[]};c.items.push(v)}break}}r.push(c)}}catch(f){l.e(f)}finally{l.f()}o>0&&(i.totalJumsu=o,i.problems=r)}))},a.readAsBinaryString(e.files[0]),this.$refs.file.value=""},sampleDown:function(){location.href=c.My},validate:function(){if(this.$v.$touch(),!this.$v.$anyError){if(!this.fileName){var t={message:"엑셀파일을 첨부하세요"};return void this.$eventBus.$emit("modalOpen",t)}this.formSubmit()}},formSubmit:function(){var t=this;if(!this.insertFlag){this.insertFlag=!0;var i={parentId:this.no.toString(),subject:this.name,author:this.author,timelimit:parseInt(this.timelimit),totalJumsu:parseInt(this.totalJumsu),problems:JSON.stringify(this.problems)};this.$eventBus.$emit("overlay","show"),d.Z.post(c.lk,i,(function(i){t.$eventBus.$emit("overlay","hide");var e={};t.insertFlag=!1,"message"==i.status?(e={message:"잘못된 접근입니다"},t.$eventBus.$emit("modalOpen",e)):(e={message:"정보가 저장되었습니다",doAction:function(){t.$router.push("/video/setting/dataList/all")}},t.$eventBus.$emit("modalOpen",e))}))}}}},v=m,f=e(1001),h=e(43453),p=e.n(h),b=e(63150),g=e(85827),C=e(55978),$=(0,f.Z)(v,s,a,!1,null,"19ae088b",null),_=$.exports;p()($,{VBtn:b.Z,VExpandTransition:g.Fx,VTextField:C.Z})},70031:function(t,i,e){t.exports=e.p+"img/05_guide.20c39ee7.jpg"}}]);
//# sourceMappingURL=7318-legacy.2f0438ef.js.map