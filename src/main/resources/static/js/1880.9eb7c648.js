"use strict";(self["webpackChunklivego"]=self["webpackChunklivego"]||[]).push([[1880],{3069:function(e,s,t){var o=t(8372),n=t.n(o),i=t(9848);s["Z"]={DEBUG:!1,jsonRpcUrl:i.Y,connected:!1,jsonRpcClientWs:null,sessionId:null,roomId:"",initMethod:"",userId:null,vue:null,accessType:"no",userName:"",userEmail:"",init(e,s,t){this.DEBUG=t,e.uid&&e.roomId&&(this.connected||("yes"==e.roomHost?this.initMethod="makeLiveRoom":(this.initMethod="joinRoom",e.accessType&&(this.accessType=e.accessType),e.name&&(this.userName=e.name),e.email&&(this.userEmail=e.email)),this.roomId=e.roomId,this.vue=s,this.userId=e.uid,this.setConnect()))},setConnect(){let e="wss";this.DEBUG&&(e="ws");const s=e+"://"+this.jsonRpcUrl+"/jsonRpc",t={hearbeat:5e3,sendCloseMessage:!1,ws:{uri:s,useSockJS:!1,onconnected:()=>{this.connected=!0,this.socketInit()},ondisconnect:this.disconnectCallback(this),onreconnected:this.connectReCallback(this)},rpc:{requestTimeout:5e3,sendResponse:e=>{this.callMessage(e)}}};this.jsonRpcClientWs=new(n().clients.JsonRpcClient)(t)},connectReCallback(e){e.connected=!0},disconnectCallback(e){e.connected=!1},close(e){let s={responseMethod:"liveClose"};this.connected&&this.userId&&this.roomId&&(s.uid=this.userId,s.sessionId=this.sessionId,s.userType=e,s.roomId=this.roomId,this.jsonRpcClientWs.send("liveClose",s,(function(e,s){e?console.log(e):(console.log("--succ--"),console.log(s))})))},callMessage(e){switch(e.responseMethod){case"forceHostOut":this.vue.$eventBus.$emit("modalOpen",{message:"다른곳에서 강제 방송정지 시켰습니다",doAction:()=>{window.close()}});break;default:this.vue.$eventBus.$emit("rpcJsonTransfer",e);break}},socketInit(){let e={interval:5e3,operation:"connect",uid:this.userId,accessType:this.accessType,roomId:this.roomId,name:this.userName,email:this.userEmail,responseMethod:this.initMethod};this.jsonRpcClientWs.send(this.initMethod,e,((e,s)=>{if(e)console.log(e);else switch(console.log(s,"succ"),this.sessionId=s.sessionId,s.map.result){case"double":"makeLiveRoom"==this.initMethod?this.vue.$eventBus.$emit("modalOpen",{message:"다른곳에서 이미 방송중입니다",doAction:()=>{window.close()}}):this.vue.$eventBus.$emit("modalOpen",{message:"동일 컴퓨터에서 이미 동일한 방에 접근 중입니다",doAction:()=>{window.close()}});break;case"fail":this.vue.$eventBus.$emit("modalOpen",{message:"잘못된 접근입니다",doAction:()=>{window.close()}});break;case"success":if("makeLiveRoom"==this.initMethod&&s.map.waitUsers){const e={responseMethod:"makeLiveRoomWaitUsers",waitUsers:s.map.waitUsers};this.vue.$eventBus.$emit("rpcJsonTransfer",e)}break}}))},send(e,s){this.sessionId&&(e.uid=this.userId,e.sessionId=this.sessionId,e.roomId=this.roomId,console.log(e,"--------iframe send -----------------"),this.jsonRpcClientWs.send(e.sendMethod,e,(function(e,t){e?console.log(e):(console.log(t),s(t))})))},forceHostOut(){if(!this.sessionId)return;let e={uid:this.userId,roomId:this.roomId,sessionId:this.sessionId,responseMethod:"forceHostOut"};this.jsonRpcClientWs.send("forceHostOut",e,(function(e,s){e?console.log(e):console.log(s)}))},post(e,s){}}},1122:function(e,s,t){var o=t(9755),n=t.n(o);s["Z"]={errorPosiFlag:!1,nl2br(e){return e.value.replace(/(\n|\r\n)/g,"<br>")},nl2brContent(e){return e=e.toString(),e=e.replace(/(\n|\r\n)/g,"<br>"),e.replace(/(<br><br>)/g,"<br>")},stripTags(e){let s=document.createElement("div");s.innerHTML=e;let t=s.textContent||s.innerText||"";return t},stripTagsNotEm(e){let s=document.createElement("div");s.innerHTML=e.replace(/<em>/gi,"{em}").replace(/<\/em>/gi,"{/em}");let t=s.textContent||s.innerText||"",o=t.replace(/{em}/gi,"<em>").replace(/{\/em}/gi,"</em>");return o},email(e){const s=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return s.test(e)},numericByPrice(e){if(0==e)return!1;if(e){e=e.toString();let s=e.replace(/,/gi,"");return s=s.toString().replace(/-/gi,""),isNaN(s)}return!0},numeric(e){return isNaN(e)},parseNumber(e){if(e){e=e.toString();let s=e.replace(/,/gi,"");return s=s.toString().replace(/-/gi,""),parseInt(s)}return 0},price(e){if(e){e=e.toString();let s=e.replace(/,/gi,"");return s=s.toString().replace(/-/gi,""),!this.numeric(s)&&this.numberFormat(s)}return!1},br2nl(e){return e.replace(/(<br>|<br\/>|<br \/>)/g,"\r")},numberFormat(e){if(!e)return 0;isNaN(e)&&(e=e.toString().replace(/-/gi,""));let s=new Intl.NumberFormat(["en-US"],{});return s.format(e)},fNumberFormat(e){e=e.toString().replace(/-/gi,""),e=e.toString().replace(/,/gi,"");let s=new Intl.NumberFormat(["en-US"],{});return s.format(e)},getStrCut(e,s){return e.length>=s?e.substr(0,s)+"..":e},errorPosition(e,s,t){const o="base"==e?n()("body"):n()(e),i=n()(o).height(),r=n()(s).offset().top,a=r>0?i-r+200:i+r-200;"base"==e?n()("html,body").animate({scrollTop:r-50},100,(()=>{this.errorPosiFlag?this.errorPosiFlag=!1:(t(),this.errorPosiFlag=!0)})):n()(o).animate({scrollTop:a},100,(()=>{t()}))}}},6719:function(e,s,t){t(3699),t(1122);var o=t(3069),n=t(9755),i=t.n(n);s["Z"]={id:"",uid:"",vue:null,streamRoomId:"",init(e,s){this.id=e.id,this.uid=e.uid,this.streamRoomId=this.id+"_"+this.uid,this.vue=s},sendToUser(e,s){let t={};switch(e.page){case"exam":"sendProblem"==e.action&&(this.sendRpcData(e.no,"insertProblem",s),t.userReponseParams={parentId:this.id,no:e.no,type:"insertProblem"},t.userReponseShow=!0),t.screenShow="close",t.close="loadExamShow";break;case"immExam":"sendProblem"==e.action&&(this.sendRpcData(e.no,"insertProblem",s),t.userReponseParams={parentId:this.id,no:e.no,type:"insertProblem"},t.userReponseShow=!0),t.screenShow="close",t.close="loadImmExamShow";break;case"quiz":"sendQuiz"==e.action&&(this.sendRpcData(e.no,"insertQuiz",s),t.userReponseParams={parentId:this.id,no:e.no,type:"insertQuiz"},t.userReponseShow=!0),t.screenShow="close",t.close="loadQuizShow";break;case"poll":"sendPoll"==e.action&&(this.sendRpcData(e.no,"insertPoll",s),t.userReponseParams={parentId:this.id,no:e.no,type:"insertPoll"},t.userReponseShow=!0),t.screenShow="close",t.close="loadPollShow";break;case"vote":"sendVote"==e.action&&(this.sendRpcData(e.no,"insertVote",s),t.userReponseParams={parentId:this.id,no:e.no,type:"insertVote"},t.userReponseShow=!0),t.screenShow="close",t.close="loadPollShow";break;case"userResponse":if("forceEnd"==e.action){let t="";switch(e.gtype){case"insertProblem":t="시험을";break;case"insertPoll":t="설문조사를";break;case"insertVote":t="투표를";break;case"insertQuiz":t="간단퀴즈를";break}let o={type:"confirm",message:t+" 강제 종료하시겠습니까?",doAction:()=>{this.modalResponse("forceResponseEnd"),i()("#app-response").hide(),s({cmd:"responseClose"})}};this.vue.$eventBus.$emit("modalOpen",o)}else if("barHide"==e.action){switch(e.gtype){case"insertProblem":t.responseTitle="시험 진행중";break;case"insertPoll":t.responseTitle="설문 진행중";break;case"insertVote":t.responseTitle="투표 진행중";break;case"insertQuiz":t.responseTitle="간단퀴즈 진행중";break}i()("#app-response").hide(),i()("#menu-response-box").show()}else i()("#app-response").hide(),t.userReponseShow="close";break;case"fileView":t.close="loadFileShow",t.fileNo="empty",t.screenShow="close";break;case"data":if("share"==e.action){t.fileNo=e.fdata.id,t.open="loadFileShow";let s={sendMethod:"insertFdata",data:e.fdata.id,responseMethod:"insertFdata"};o.Z.send(s,(e=>{}))}else t.screenShow="close";t.close="loadDataShow"}return t},sendRpcData(e,s,t){let n,r={sendMethod:s,data:e,responseMethod:s};switch(o.Z.send(r,(e=>{t({cmd:"responseOpen",data:e})})),s){case"insertProblem":n="시험을 출제하였습니다";break;case"insertPoll":n="설문조사를 시작하였습니다";break;case"insertVote":n="투료를 시작하였습니다";break;case"insertQuiz":n="간단퀴즈를 출제하였습니다";break}i()("#app-response").show();let a={type:"timeout",message:n};this.vue.$eventBus.$emit("modalOpen",a)},rpcSend(e){o.Z.send(e,(e=>{}))},modalResponse(e){switch(e){case"forceResponseEnd":let e={sendMethod:"forceResponseEnd",data:"none",responseMethod:"forceResponseEnd"};o.Z.send(e,(()=>{}));break}}}},1880:function(e,s,t){t.r(s),t.d(s,{default:function(){return u}});var o=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",[e._v(" user ")])},n=[],i=t(359),r=t(6065),a=t(6719),c={name:"testUserJsonRpc",data(){return{id:"",uid:"",hostUid:"",userName:"홍길동",userEmail:"te1st@nt.com",accessType:"yes"}},created(){this.id=this.$route.params.id,this.uid=this.$route.params.uid,this.hostUid=this.$route.params.hostUid,this.getMeetingInfo()},methods:{getMeetingInfo(){const e={id:this.id.toString(),uid:this.uid,userName:this.userName,userEmail:this.userEmail};i.Z.init(e,this,!0),r.Z.init(e,this);const s=this.id+"_"+this.hostUid;i.Z.setStreamRoomId(s),this.$eventBus.$on("rpcJsonTransfer",this.transferAction),this.$eventBus.$on("rpcTestJsonTransfer",this.testTransferAction),i.Z.joinSocketRoom()},transferAction(e){window.parent.postMessage(e,"https://localhost")},testTransferAction(e){a.Z.rpcSend(e)}},destroyed(){this.$eventBus.$off("rpcJsonTransfer"),this.$eventBus.$off("rpcTestJsonTransfer")}},l=c,d=t(1001),h=(0,d.Z)(l,o,n,!1,null,null,null),u=h.exports}}]);
//# sourceMappingURL=1880.9eb7c648.js.map