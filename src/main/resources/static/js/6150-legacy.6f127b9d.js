"use strict";(self["webpackChunklivego"]=self["webpackChunklivego"]||[]).push([[6150],{23069:function(e,t,n){n(68309),n(21249);var s=n(18372),i=n.n(s),o=n(99848);t["Z"]={DEBUG:!1,jsonRpcUrl:o.Y,connected:!1,jsonRpcClientWs:null,sessionId:null,roomId:"",initMethod:"",userId:null,vue:null,accessType:"no",userName:"",userEmail:"",init:function(e,t,n){this.DEBUG=n,e.uid&&e.roomId&&(this.connected||("yes"==e.roomHost?this.initMethod="makeLiveRoom":(this.initMethod="joinRoom",e.accessType&&(this.accessType=e.accessType),e.name&&(this.userName=e.name),e.email&&(this.userEmail=e.email)),this.roomId=e.roomId,this.vue=t,this.userId=e.uid,this.setConnect()))},setConnect:function(){var e=this;var t="wss";this.DEBUG&&(t="ws");var n=t+"://"+this.jsonRpcUrl+"/jsonRpc",s={hearbeat:5e3,sendCloseMessage:!1,ws:{uri:n,useSockJS:!1,onconnected:function(){e.connected=!0,e.socketInit()},ondisconnect:this.disconnectCallback(this),onreconnected:this.connectReCallback(this)},rpc:{requestTimeout:5e3,sendResponse:function(t){e.callMessage(t)}}};this.jsonRpcClientWs=new(i().clients.JsonRpcClient)(s)},connectReCallback:function(e){e.connected=!0},disconnectCallback:function(e){e.connected=!1},close:function(e){var t={};t.responseMethod="liveClose",this.connected&&this.userId&&this.roomId&&(t.uid=this.userId,t.sessionId=this.sessionId,t.userType=e,t.roomId=this.roomId,this.jsonRpcClientWs.send("liveClose",t,(function(e,t){e?console.log(e):(console.log("--succ--"),console.log(t))})))},callMessage:function(e){switch(e.responseMethod){case"forceHostOut":this.vue.$eventBus.$emit("modalOpen",{message:"다른곳에서 강제 방송정지 시켰습니다",doAction:function(){window.close()}});break;default:this.vue.$eventBus.$emit("rpcJsonTransfer",e);break}},socketInit:function(){var e=this,t={interval:5e3,operation:"connect",uid:this.userId,accessType:this.accessType,roomId:this.roomId,name:this.userName,email:this.userEmail,responseMethod:this.initMethod};this.jsonRpcClientWs.send(this.initMethod,t,(function(t,n){if(t)console.log(t);else switch(console.log(n,"succ"),e.sessionId=n.sessionId,n.map.result){case"double":"makeLiveRoom"==e.initMethod?e.vue.$eventBus.$emit("modalOpen",{message:"다른곳에서 이미 방송중입니다",doAction:function(){window.close()}}):e.vue.$eventBus.$emit("modalOpen",{message:"동일 컴퓨터에서 이미 동일한 방에 접근 중입니다",doAction:function(){window.close()}});break;case"fail":e.vue.$eventBus.$emit("modalOpen",{message:"잘못된 접근입니다",doAction:function(){window.close()}});break;case"success":if("makeLiveRoom"==e.initMethod&&n.map.waitUsers){var s={responseMethod:"makeLiveRoomWaitUsers",waitUsers:n.map.waitUsers};e.vue.$eventBus.$emit("rpcJsonTransfer",s)}break}}))},send:function(e,t){this.sessionId&&(e.uid=this.userId,e.sessionId=this.sessionId,e.roomId=this.roomId,console.log(e,"--------iframe send -----------------"),this.jsonRpcClientWs.send(e.sendMethod,e,(function(e,n){e?console.log(e):(console.log(n),t(n))})))},forceHostOut:function(){if(this.sessionId){var e={uid:this.userId,roomId:this.roomId,sessionId:this.sessionId,responseMethod:"forceHostOut"};this.jsonRpcClientWs.send("forceHostOut",e,(function(e,t){e?console.log(e):console.log(t)}))}},post:function(e,t){}}},1122:function(e,t,n){n(74916),n(15306),n(41539),n(39714),n(77601);var s=n(19755),i=n.n(s);t["Z"]={errorPosiFlag:!1,nl2br:function(e){return e.value.replace(/(\n|\r\n)/g,"<br>")},nl2brContent:function(e){return e=e.toString(),e=e.replace(/(\n|\r\n)/g,"<br>"),e.replace(/(<br><br>)/g,"<br>")},stripTags:function(e){var t=document.createElement("div");t.innerHTML=e;var n=t.textContent||t.innerText||"";return n},stripTagsNotEm:function(e){var t=document.createElement("div");t.innerHTML=e.replace(/<em>/gi,"{em}").replace(/<\/em>/gi,"{/em}");var n=t.textContent||t.innerText||"",s=n.replace(/{em}/gi,"<em>").replace(/{\/em}/gi,"</em>");return s},email:function(e){var t=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return t.test(e)},numericByPrice:function(e){if(0==e)return!1;if(e){e=e.toString();var t=e.replace(/,/gi,"");return t=t.toString().replace(/-/gi,""),isNaN(t)}return!0},numeric:function(e){return isNaN(e)},parseNumber:function(e){if(e){e=e.toString();var t=e.replace(/,/gi,"");return t=t.toString().replace(/-/gi,""),parseInt(t)}return 0},price:function(e){if(e){e=e.toString();var t=e.replace(/,/gi,"");return t=t.toString().replace(/-/gi,""),!this.numeric(t)&&this.numberFormat(t)}return!1},br2nl:function(e){return e.replace(/(<br>|<br\/>|<br \/>)/g,"\r")},numberFormat:function(e){if(!e)return 0;isNaN(e)&&(e=e.toString().replace(/-/gi,""));var t=new Intl.NumberFormat(["en-US"],{});return t.format(e)},fNumberFormat:function(e){e=e.toString().replace(/-/gi,""),e=e.toString().replace(/,/gi,"");var t=new Intl.NumberFormat(["en-US"],{});return t.format(e)},getStrCut:function(e,t){return e.length>=t?e.substr(0,t)+"..":e},errorPosition:function(e,t,n){var s=this,o="base"==e?i()("body"):i()(e),r=i()(o).height(),a=i()(t).offset().top,c=a>0?r-a+200:r+a-200;"base"==e?i()("html,body").animate({scrollTop:a-50},100,(function(){s.errorPosiFlag?s.errorPosiFlag=!1:(n(),s.errorPosiFlag=!0)})):i()(o).animate({scrollTop:c},100,(function(){n()}))}}},76719:function(e,t,n){n(3699),n(1122);var s=n(23069),i=n(19755),o=n.n(i);t["Z"]={id:"",uid:"",vue:null,streamRoomId:"",init:function(e,t){this.id=e.id,this.uid=e.uid,this.streamRoomId=this.id+"_"+this.uid,this.vue=t},sendToUser:function(e,t){var n=this,i={};switch(e.page){case"exam":"sendProblem"==e.action&&(this.sendRpcData(e.no,"insertProblem",t),i.userReponseParams={parentId:this.id,no:e.no,type:"insertProblem"},i.userReponseShow=!0),i.screenShow="close",i.close="loadExamShow";break;case"immExam":"sendProblem"==e.action&&(this.sendRpcData(e.no,"insertProblem",t),i.userReponseParams={parentId:this.id,no:e.no,type:"insertProblem"},i.userReponseShow=!0),i.screenShow="close",i.close="loadImmExamShow";break;case"quiz":"sendQuiz"==e.action&&(this.sendRpcData(e.no,"insertQuiz",t),i.userReponseParams={parentId:this.id,no:e.no,type:"insertQuiz"},i.userReponseShow=!0),i.screenShow="close",i.close="loadQuizShow";break;case"poll":"sendPoll"==e.action&&(this.sendRpcData(e.no,"insertPoll",t),i.userReponseParams={parentId:this.id,no:e.no,type:"insertPoll"},i.userReponseShow=!0),i.screenShow="close",i.close="loadPollShow";break;case"vote":"sendVote"==e.action&&(this.sendRpcData(e.no,"insertVote",t),i.userReponseParams={parentId:this.id,no:e.no,type:"insertVote"},i.userReponseShow=!0),i.screenShow="close",i.close="loadPollShow";break;case"userResponse":if("forceEnd"==e.action){var r="";switch(e.gtype){case"insertProblem":r="시험을";break;case"insertPoll":r="설문조사를";break;case"insertVote":r="투표를";break;case"insertQuiz":r="간단퀴즈를";break}var a={type:"confirm",message:r+" 강제 종료하시겠습니까?",doAction:function(){n.modalResponse("forceResponseEnd"),o()("#app-response").hide(),t({cmd:"responseClose"})}};this.vue.$eventBus.$emit("modalOpen",a)}else if("barHide"==e.action){switch(e.gtype){case"insertProblem":i.responseTitle="시험 진행중";break;case"insertPoll":i.responseTitle="설문 진행중";break;case"insertVote":i.responseTitle="투표 진행중";break;case"insertQuiz":i.responseTitle="간단퀴즈 진행중";break}o()("#app-response").hide(),o()("#menu-response-box").show()}else o()("#app-response").hide(),i.userReponseShow="close";break;case"fileView":i.close="loadFileShow",i.fileNo="empty",i.screenShow="close";break;case"data":if("share"==e.action){i.fileNo=e.fdata.id,i.open="loadFileShow";var c={sendMethod:"insertFdata",data:e.fdata.id,responseMethod:"insertFdata"};s.Z.send(c,(function(e){}))}else i.screenShow="close";i.close="loadDataShow"}return i},sendRpcData:function(e,t,n){var i,r={sendMethod:t,data:e,responseMethod:t};switch(s.Z.send(r,(function(e){n({cmd:"responseOpen",data:e})})),t){case"insertProblem":i="시험을 출제하였습니다";break;case"insertPoll":i="설문조사를 시작하였습니다";break;case"insertVote":i="투료를 시작하였습니다";break;case"insertQuiz":i="간단퀴즈를 출제하였습니다";break}o()("#app-response").show();var a={type:"timeout",message:i};this.vue.$eventBus.$emit("modalOpen",a)},rpcSend:function(e){s.Z.send(e,(function(e){}))},modalResponse:function(e){switch(e){case"forceResponseEnd":var t={sendMethod:"forceResponseEnd",data:"none",responseMethod:"forceResponseEnd"};s.Z.send(t,(function(){}));break}}}},74730:function(e,t,n){n(41539),n(39714),n(69826),n(38862),n(3699),n(1122);var s=n(89486),i=n(25494),o=n(23069),r=n(19755),a=n.n(r);t["Z"]={DEBUG:!1,id:"",uid:"",streamRoomId:"",liveIngTimeKey:"",liveIngTime:"",vue:null,chatProcess:!1,init:function(e,t,n){this.DEBUG=n,this.id=e.id,this.uid=e.uid,this.streamRoomId=this.id+"_"+this.uid,this.liveIngTimeKey=this.streamRoomId+"_liveStramHostTime",this.vue=t},getLiveInfo:function(e){var t=this,n={id:this.id};s.Z.post(i.fQ,n,(function(n){var s=new Date;n.info.start_time&&(s=new Date(n.info.start_time)),t.liveIngTime=parseInt(s.getTime()),e(n)}))},getStartTime:function(){var e=parseInt(this.liveIngTime),t=new Date,n=(t.getTime()-e)/1e3;return n=Math.floor(n),n<0&&(n=0),n},updateLiveTime:function(){},liveTimeRemove:function(){},joinSocketLiveStream:function(){var e={uid:this.uid,roomId:this.streamRoomId,roomHost:"yes"};o.Z.init(e,this.vue,this.DEBUG);var t={id:this.id.toString()};s.Z.post(i.ED,t,(function(e){}))},setTimeVal:function(e){if(e=parseInt(e),isNaN(e))return"00:00:00";if(e<0)return"00:00:00";var t=e%60;t=Math.floor(t);var n,s=e/60;s=Math.floor(s),n=s>=60?s%60:s,n=Math.floor(n);var i,o=s/60;o=Math.floor(o);var r="";return i=o>=24?o%24:o,i=Math.floor(i),r+this.zf(i)+":"+this.zf(n)+":"+this.zf(t)},zf:function(e){return e=parseInt(e),e<10?"0"+e:e},doEndMeetingActive:function(e){e?this.mobileRecodeChatAct():this.recodeChatAct(),o.Z.close("host");var t={id:this.id.toString()};s.Z.post(i.Jw,t,(function(e){}))},mobileRecodeChatAct:function(){var e=this,t=a()(".zmwebsdk-makeStyles-chatCustomize-10");if(t.html())this.mobileSaveChatAct();else{var n=a()("#menu-list-icon-more");if(n.html())a()("#menu-list-icon-more li:nth-child(2)").click(),setTimeout((function(){e.mobileSaveChatAct()}),500);else{var s=a()("#meetingSDKElement div.zmwebsdk-MuiPaper-root.zmwebsdk-makeStyles-root-58.zmwebsdk-MuiPaper-elevation1.zmwebsdk-MuiPaper-rounded > div:nth-child(5) > button");a()(s).click(),setTimeout((function(){a()("#menu-list-icon-more li:nth-child(2)").click(),setTimeout((function(){e.mobileSaveChatAct()}),500)}),500)}}},mobileSaveChatAct:function(){if(!this.chatProcess){this.chatProcess=!0;var e,t,n,s=a()(".ReactVirtualized__Grid__innerScrollContainer > li"),i=[];s.each((function(){e=a()(this).find("button:eq(0)").text(),t=a()(this).find("button:eq(1)").text(),n=a()(this).find(".zmwebsdk-MuiListItemText-root span").text(),e&&t?i.push({to:t,from:e,time:"",msg:n}):i.push({to:"",from:"",time:"",msg:n})}));var o={message:JSON.stringify(i),parentId:this.id.toString()};this.updateChat(o)}},recodeChatAct:function(){var e=a()("#wc-content #wc-footer .footer-chat-button button");if(a()("#wc-container-right")){if(a()("#wc-container-right .chat-container").html())this.saveChatAct();else if(e){e.click();var t=this;setTimeout((function(){t.saveChatAct()}),500)}}else if(e){e.click();var n=this;setTimeout((function(){n.saveChatAct()}),500)}},saveChatAct:function(){if(!this.chatProcess){this.chatProcess=!0;var e,t,n,s,i=a()("#wc-container-right .chat-container .ReactVirtualized__Grid__innerScrollContainer > div"),o=[];i.each((function(){e=a()(this).find(".chat-item__chat-info-header").find("span:eq(0)").text(),t=a()(this).find(".chat-item__chat-info-header").find("span:eq(2)").text(),n=a()(this).find(".chat-item__chat-info-header").find("span:eq(4)").text(),s=a()(this).find(".chat-message__text-content").text(),e&&t&&n?o.push({to:t,from:e,time:n,msg:s}):o.push({to:"",from:"",time:"",msg:s})}));var r={message:JSON.stringify(o),parentId:this.id.toString()};this.updateChat(r)}},updateChat:function(e){var t=this;s.Z.post(i.dl,e,(function(e){t.chatProcess=!1}))}}},86150:function(e,t,n){n.r(t),n.d(t,{default:function(){return h}});var s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div")},i=[],o=(n(41539),n(39714),n(74730)),r=n(76719),a={name:"testJsonRpc",data:function(){return{id:"",uid:""}},created:function(){this.id=this.$route.params.id,this.uid=this.$route.params.uid,this.getMeetingInfo()},methods:{getMeetingInfo:function(){var e={id:this.id.toString(),uid:this.uid};o.Z.init(e,this,!0),r.Z.init(e,this),this.$eventBus.$on("rpcJsonTransfer",this.transferAction),this.$eventBus.$on("rpcTestJsonTransfer",this.testTransferAction),o.Z.joinSocketLiveStream()},transferAction:function(e){window.parent.postMessage(e,"https://localhost")},testTransferAction:function(e){r.Z.rpcSend(e)}},destroyed:function(){this.$eventBus.$off("rpcJsonTransfer"),this.$eventBus.$off("rpcTestJsonTransfer")}},c=a,u=n(1001),d=(0,u.Z)(c,s,i,!1,null,null,null),h=d.exports}}]);
//# sourceMappingURL=6150-legacy.6f127b9d.js.map