"use strict";(self["webpackChunklivego"]=self["webpackChunklivego"]||[]).push([[6150],{3069:function(e,t,s){var i=s(8372),o=s.n(i),n=s(9848);t["Z"]={DEBUG:!1,jsonRpcUrl:n.Y,connected:!1,jsonRpcClientWs:null,sessionId:null,roomId:"",initMethod:"",userId:null,vue:null,accessType:"no",userName:"",userEmail:"",init(e,t,s){this.DEBUG=s,e.uid&&e.roomId&&(this.connected||("yes"==e.roomHost?this.initMethod="makeLiveRoom":(this.initMethod="joinRoom",e.accessType&&(this.accessType=e.accessType),e.name&&(this.userName=e.name),e.email&&(this.userEmail=e.email)),this.roomId=e.roomId,this.vue=t,this.userId=e.uid,this.setConnect()))},setConnect(){let e="wss";this.DEBUG&&(e="ws");const t=e+"://"+this.jsonRpcUrl+"/jsonRpc",s={hearbeat:5e3,sendCloseMessage:!1,ws:{uri:t,useSockJS:!1,onconnected:()=>{this.connected=!0,this.socketInit()},ondisconnect:this.disconnectCallback(this),onreconnected:this.connectReCallback(this)},rpc:{requestTimeout:5e3,sendResponse:e=>{this.callMessage(e)}}};this.jsonRpcClientWs=new(o().clients.JsonRpcClient)(s)},connectReCallback(e){e.connected=!0},disconnectCallback(e){e.connected=!1},close(e){let t={responseMethod:"liveClose"};this.connected&&this.userId&&this.roomId&&(t.uid=this.userId,t.sessionId=this.sessionId,t.userType=e,t.roomId=this.roomId,this.jsonRpcClientWs.send("liveClose",t,(function(e,t){e?console.log(e):(console.log("--succ--"),console.log(t))})))},callMessage(e){switch(e.responseMethod){case"forceHostOut":this.vue.$eventBus.$emit("modalOpen",{message:"다른곳에서 강제 방송정지 시켰습니다",doAction:()=>{window.close()}});break;default:this.vue.$eventBus.$emit("rpcJsonTransfer",e);break}},socketInit(){let e={interval:5e3,operation:"connect",uid:this.userId,accessType:this.accessType,roomId:this.roomId,name:this.userName,email:this.userEmail,responseMethod:this.initMethod};this.jsonRpcClientWs.send(this.initMethod,e,((e,t)=>{if(e)console.log(e);else switch(console.log(t,"succ"),this.sessionId=t.sessionId,t.map.result){case"double":"makeLiveRoom"==this.initMethod?this.vue.$eventBus.$emit("modalOpen",{message:"다른곳에서 이미 방송중입니다",doAction:()=>{window.close()}}):this.vue.$eventBus.$emit("modalOpen",{message:"동일 컴퓨터에서 이미 동일한 방에 접근 중입니다",doAction:()=>{window.close()}});break;case"fail":this.vue.$eventBus.$emit("modalOpen",{message:"잘못된 접근입니다",doAction:()=>{window.close()}});break;case"success":if("makeLiveRoom"==this.initMethod&&t.map.waitUsers){const e={responseMethod:"makeLiveRoomWaitUsers",waitUsers:t.map.waitUsers};this.vue.$eventBus.$emit("rpcJsonTransfer",e)}break}}))},send(e,t){this.sessionId&&(e.uid=this.userId,e.sessionId=this.sessionId,e.roomId=this.roomId,console.log(e,"--------iframe send -----------------"),this.jsonRpcClientWs.send(e.sendMethod,e,(function(e,s){e?console.log(e):(console.log(s),t(s))})))},forceHostOut(){if(!this.sessionId)return;let e={uid:this.userId,roomId:this.roomId,sessionId:this.sessionId,responseMethod:"forceHostOut"};this.jsonRpcClientWs.send("forceHostOut",e,(function(e,t){e?console.log(e):console.log(t)}))},post(e,t){}}},1122:function(e,t,s){var i=s(9755),o=s.n(i);t["Z"]={errorPosiFlag:!1,nl2br(e){return e.value.replace(/(\n|\r\n)/g,"<br>")},nl2brContent(e){return e=e.toString(),e=e.replace(/(\n|\r\n)/g,"<br>"),e.replace(/(<br><br>)/g,"<br>")},stripTags(e){let t=document.createElement("div");t.innerHTML=e;let s=t.textContent||t.innerText||"";return s},stripTagsNotEm(e){let t=document.createElement("div");t.innerHTML=e.replace(/<em>/gi,"{em}").replace(/<\/em>/gi,"{/em}");let s=t.textContent||t.innerText||"",i=s.replace(/{em}/gi,"<em>").replace(/{\/em}/gi,"</em>");return i},email(e){const t=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return t.test(e)},numericByPrice(e){if(0==e)return!1;if(e){e=e.toString();let t=e.replace(/,/gi,"");return t=t.toString().replace(/-/gi,""),isNaN(t)}return!0},numeric(e){return isNaN(e)},parseNumber(e){if(e){e=e.toString();let t=e.replace(/,/gi,"");return t=t.toString().replace(/-/gi,""),parseInt(t)}return 0},price(e){if(e){e=e.toString();let t=e.replace(/,/gi,"");return t=t.toString().replace(/-/gi,""),!this.numeric(t)&&this.numberFormat(t)}return!1},br2nl(e){return e.replace(/(<br>|<br\/>|<br \/>)/g,"\r")},numberFormat(e){if(!e)return 0;isNaN(e)&&(e=e.toString().replace(/-/gi,""));let t=new Intl.NumberFormat(["en-US"],{});return t.format(e)},fNumberFormat(e){e=e.toString().replace(/-/gi,""),e=e.toString().replace(/,/gi,"");let t=new Intl.NumberFormat(["en-US"],{});return t.format(e)},getStrCut(e,t){return e.length>=t?e.substr(0,t)+"..":e},errorPosition(e,t,s){const i="base"==e?o()("body"):o()(e),n=o()(i).height(),r=o()(t).offset().top,a=r>0?n-r+200:n+r-200;"base"==e?o()("html,body").animate({scrollTop:r-50},100,(()=>{this.errorPosiFlag?this.errorPosiFlag=!1:(s(),this.errorPosiFlag=!0)})):o()(i).animate({scrollTop:a},100,(()=>{s()}))}}},6719:function(e,t,s){s(3699),s(1122);var i=s(3069),o=s(9755),n=s.n(o);t["Z"]={id:"",uid:"",vue:null,streamRoomId:"",init(e,t){this.id=e.id,this.uid=e.uid,this.streamRoomId=this.id+"_"+this.uid,this.vue=t},sendToUser(e,t){let s={};switch(e.page){case"exam":"sendProblem"==e.action&&(this.sendRpcData(e.no,"insertProblem",t),s.userReponseParams={parentId:this.id,no:e.no,type:"insertProblem"},s.userReponseShow=!0),s.screenShow="close",s.close="loadExamShow";break;case"immExam":"sendProblem"==e.action&&(this.sendRpcData(e.no,"insertProblem",t),s.userReponseParams={parentId:this.id,no:e.no,type:"insertProblem"},s.userReponseShow=!0),s.screenShow="close",s.close="loadImmExamShow";break;case"quiz":"sendQuiz"==e.action&&(this.sendRpcData(e.no,"insertQuiz",t),s.userReponseParams={parentId:this.id,no:e.no,type:"insertQuiz"},s.userReponseShow=!0),s.screenShow="close",s.close="loadQuizShow";break;case"poll":"sendPoll"==e.action&&(this.sendRpcData(e.no,"insertPoll",t),s.userReponseParams={parentId:this.id,no:e.no,type:"insertPoll"},s.userReponseShow=!0),s.screenShow="close",s.close="loadPollShow";break;case"vote":"sendVote"==e.action&&(this.sendRpcData(e.no,"insertVote",t),s.userReponseParams={parentId:this.id,no:e.no,type:"insertVote"},s.userReponseShow=!0),s.screenShow="close",s.close="loadPollShow";break;case"userResponse":if("forceEnd"==e.action){let s="";switch(e.gtype){case"insertProblem":s="시험을";break;case"insertPoll":s="설문조사를";break;case"insertVote":s="투표를";break;case"insertQuiz":s="간단퀴즈를";break}let i={type:"confirm",message:s+" 강제 종료하시겠습니까?",doAction:()=>{this.modalResponse("forceResponseEnd"),n()("#app-response").hide(),t({cmd:"responseClose"})}};this.vue.$eventBus.$emit("modalOpen",i)}else if("barHide"==e.action){switch(e.gtype){case"insertProblem":s.responseTitle="시험 진행중";break;case"insertPoll":s.responseTitle="설문 진행중";break;case"insertVote":s.responseTitle="투표 진행중";break;case"insertQuiz":s.responseTitle="간단퀴즈 진행중";break}n()("#app-response").hide(),n()("#menu-response-box").show()}else n()("#app-response").hide(),s.userReponseShow="close";break;case"fileView":s.close="loadFileShow",s.fileNo="empty",s.screenShow="close";break;case"data":if("share"==e.action){s.fileNo=e.fdata.id,s.open="loadFileShow";let t={sendMethod:"insertFdata",data:e.fdata.id,responseMethod:"insertFdata"};i.Z.send(t,(e=>{}))}else s.screenShow="close";s.close="loadDataShow"}return s},sendRpcData(e,t,s){let o,r={sendMethod:t,data:e,responseMethod:t};switch(i.Z.send(r,(e=>{s({cmd:"responseOpen",data:e})})),t){case"insertProblem":o="시험을 출제하였습니다";break;case"insertPoll":o="설문조사를 시작하였습니다";break;case"insertVote":o="투료를 시작하였습니다";break;case"insertQuiz":o="간단퀴즈를 출제하였습니다";break}n()("#app-response").show();let a={type:"timeout",message:o};this.vue.$eventBus.$emit("modalOpen",a)},rpcSend(e){i.Z.send(e,(e=>{}))},modalResponse(e){switch(e){case"forceResponseEnd":let e={sendMethod:"forceResponseEnd",data:"none",responseMethod:"forceResponseEnd"};i.Z.send(e,(()=>{}));break}}}},4730:function(e,t,s){s(3699),s(1122);var i=s(9248),o=s(5494),n=s(3069),r=s(9755),a=s.n(r);t["Z"]={DEBUG:!1,id:"",uid:"",streamRoomId:"",liveIngTimeKey:"",liveIngTime:"",vue:null,chatProcess:!1,init(e,t,s){this.DEBUG=s,this.id=e.id,this.uid=e.uid,this.streamRoomId=this.id+"_"+this.uid,this.liveIngTimeKey=this.streamRoomId+"_liveStramHostTime",this.vue=t},getLiveInfo(e){const t={id:this.id};i.Z.post(o.fQ,t,(t=>{let s=new Date;t.info.start_time&&(s=new Date(t.info.start_time)),this.liveIngTime=parseInt(s.getTime()),e(t)}))},getStartTime(){let e=parseInt(this.liveIngTime),t=new Date,s=(t.getTime()-e)/1e3;return s=Math.floor(s),s<0&&(s=0),s},updateLiveTime(){},liveTimeRemove(){},joinSocketLiveStream(){let e={uid:this.uid,roomId:this.streamRoomId,roomHost:"yes"};n.Z.init(e,this.vue,this.DEBUG);const t={id:this.id.toString()};i.Z.post(o.ED,t,(e=>{}))},setTimeVal(e){if(e=parseInt(e),isNaN(e))return"00:00:00";if(e<0)return"00:00:00";let t=e%60;t=Math.floor(t);let s,i=e/60;i=Math.floor(i),s=i>=60?i%60:i,s=Math.floor(s);let o,n=i/60;n=Math.floor(n);let r="";return o=n>=24?n%24:n,o=Math.floor(o),r+this.zf(o)+":"+this.zf(s)+":"+this.zf(t)},zf(e){return e=parseInt(e),e<10?"0"+e:e},doEndMeetingActive(e){e?this.mobileRecodeChatAct():this.recodeChatAct(),n.Z.close("host");const t={id:this.id.toString()};i.Z.post(o.Jw,t,(e=>{}))},mobileRecodeChatAct(){const e=a()(".zmwebsdk-makeStyles-chatCustomize-10");if(e.html())this.mobileSaveChatAct();else{const e=a()("#menu-list-icon-more");if(e.html())a()("#menu-list-icon-more li:nth-child(2)").click(),setTimeout((()=>{this.mobileSaveChatAct()}),500);else{const e=a()("#meetingSDKElement div.zmwebsdk-MuiPaper-root.zmwebsdk-makeStyles-root-58.zmwebsdk-MuiPaper-elevation1.zmwebsdk-MuiPaper-rounded > div:nth-child(5) > button");a()(e).click(),setTimeout((()=>{a()("#menu-list-icon-more li:nth-child(2)").click(),setTimeout((()=>{this.mobileSaveChatAct()}),500)}),500)}}},mobileSaveChatAct(){if(this.chatProcess)return;this.chatProcess=!0;let e,t,s,i=a()(".ReactVirtualized__Grid__innerScrollContainer > li"),o=[];i.each((function(){e=a()(this).find("button:eq(0)").text(),t=a()(this).find("button:eq(1)").text(),s=a()(this).find(".zmwebsdk-MuiListItemText-root span").text(),e&&t?o.push({to:t,from:e,time:"",msg:s}):o.push({to:"",from:"",time:"",msg:s})}));let n={message:JSON.stringify(o),parentId:this.id.toString()};this.updateChat(n)},recodeChatAct(){let e=a()("#wc-content #wc-footer .footer-chat-button button");if(a()("#wc-container-right")){if(a()("#wc-container-right .chat-container").html())this.saveChatAct();else if(e){e.click();let t=this;setTimeout((function(){t.saveChatAct()}),500)}}else if(e){e.click();let t=this;setTimeout((function(){t.saveChatAct()}),500)}},saveChatAct(){if(this.chatProcess)return;this.chatProcess=!0;let e,t,s,i,o=a()("#wc-container-right .chat-container .ReactVirtualized__Grid__innerScrollContainer > div"),n=[];o.each((function(){e=a()(this).find(".chat-item__chat-info-header").find("span:eq(0)").text(),t=a()(this).find(".chat-item__chat-info-header").find("span:eq(2)").text(),s=a()(this).find(".chat-item__chat-info-header").find("span:eq(4)").text(),i=a()(this).find(".chat-message__text-content").text(),e&&t&&s?n.push({to:t,from:e,time:s,msg:i}):n.push({to:"",from:"",time:"",msg:i})}));let r={message:JSON.stringify(n),parentId:this.id.toString()};this.updateChat(r)},updateChat(e){i.Z.post(o.dl,e,(e=>{this.chatProcess=!1}))}}},6150:function(e,t,s){s.r(t),s.d(t,{default:function(){return d}});var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div")},o=[],n=s(4730),r=s(6719),a={name:"testJsonRpc",data(){return{id:"",uid:""}},created(){this.id=this.$route.params.id,this.uid=this.$route.params.uid,this.getMeetingInfo()},methods:{getMeetingInfo(){const e={id:this.id.toString(),uid:this.uid};n.Z.init(e,this,!0),r.Z.init(e,this),this.$eventBus.$on("rpcJsonTransfer",this.transferAction),this.$eventBus.$on("rpcTestJsonTransfer",this.testTransferAction),n.Z.joinSocketLiveStream()},transferAction(e){window.parent.postMessage(e,"https://localhost")},testTransferAction(e){r.Z.rpcSend(e)}},destroyed(){this.$eventBus.$off("rpcJsonTransfer"),this.$eventBus.$off("rpcTestJsonTransfer")}},c=a,l=s(1001),h=(0,l.Z)(c,i,o,!1,null,null,null),d=h.exports}}]);
//# sourceMappingURL=6150.349d17e1.js.map